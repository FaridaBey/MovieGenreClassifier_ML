from flask import Flask, jsonify
import sqlite3
import pandas as pd
import time
import tensorflow as tf
from tensorflow.keras import models
from tensorflow.keras.saving import register_keras_serializable
from tensorflow.keras import backend as K
from tensorflow.keras.models import load_model
from tensorflow.keras.utils import get_custom_objects

# Initialize Flask app
app = Flask(__name__)

# SQLite database file
DB_FILE = "database.db"


# Register custom loss for the model
@keras.saving.register_keras_serializable()
# @register_keras_serializable()
# Focal loss definition
# def focal_loss(alpha=0.25, gamma=2.0):
def loss(y_true, y_pred):
    alpha = 0.25
    gamma = 2.0
    y_true = tf.cast(y_true, tf.float32)
    y_pred = tf.clip_by_values(y_pred, K.epsilon(), 1 - K.epsilon())
    alpha_t = y_true * alpha + (1 - y_true) * (1 - alpha)
    p_t = y_true * y_pred + (1 - y_true) * (1 - y_pred)
    focal_loss_values = -alpha_t * (1 - p_t) ** gamma * K.log(p_t)
    return K.mean(focal_loss_values)
    # return loss


# Load the model
def load_model():
    try:
        my_model = keras.models.load_model("final_model.keras", custom_objects={'loss': loss})
        print("Model loaded successfully.")
        return my_model
    except Exception as e:
        print(f"Error loading model: {e}")
        return None


# Retraining logic
def retrain_model():
    connection = sqlite3.connect(DB_FILE)
    model = load_model()
    if not model:
        return "Model loading failed"

    # Load training data
    query = "SELECT * FROM data"
    df = pd.read_sql_query(query, connection)

    # Split features and target
    X_train = df.drop(columns=['target_column'])
    y_train = df['target_column']

    print("Retraining model...")
    model.fit(X_train, y_train, epochs=5, batch_size=32)

    # Save the updated model
    model.save("updated_model.keras")
    print("Model retrained and saved.")
    connection.close()
    return "Retrained and saved model."


# Get row count
def get_row_count():
    connection = sqlite3.connect(DB_FILE)
    query = "SELECT COUNT(*) AS NumOfRows FROM data"
    cursor = connection.cursor()
    cursor.execute(query)
    row_count = cursor.fetchone()[0]
    connection.close()
    return row_count


# Monitor the database for changes
def monitor_database():
    previous_row_count = get_row_count()
    while True:
        current_row_count = get_row_count()
        print(f"Previous Row Count: {previous_row_count}")
        print(f"Current Row Count: {current_row_count}")
        print("==========================================")

        if current_row_count > previous_row_count:
            if current_row_count - previous_row_count >= 100:
                print("Retraining after 100 new records added...")
                retrain_model()
                previous_row_count = current_row_count

        time.sleep(60)


# Initialize SQLite database and create table
def initialize_database():
    connection = sqlite3.connect(DB_FILE)
    cursor = connection.cursor()
    cursor.execute('''CREATE TABLE Movies (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    vote_average REAL,
    vote_count INTEGER,
    runtime REAL,
    popularity REAL,
    is_adult INTEGER,
    Canceled INTEGER,
    In_Production INTEGER,
    Planned INTEGER,
    Post_Production INTEGER,
    Released INTEGER,
    Rumored INTEGER,
    aa INTEGER,
    ab INTEGER,
    af INTEGER,
    ak INTEGER,
    am INTEGER,
    ar INTEGER,
    as INTEGER,
    ay INTEGER,
    az INTEGER,
    ba INTEGER,
    be INTEGER,
    bg INTEGER,
    bi INTEGER,
    bm INTEGER,
    bn INTEGER,
    bo INTEGER,
    br INTEGER,
    bs INTEGER,
    ca INTEGER,
    ce INTEGER,
    ch INTEGER,
    cn INTEGER,
    co INTEGER,
    cr INTEGER,
    cs INTEGER,
    cv INTEGER,
    cy INTEGER,
    da INTEGER,
    de INTEGER,
    dv INTEGER,
    dz INTEGER,
    el INTEGER,
    en INTEGER,
    eo INTEGER,
    es INTEGER,
    et INTEGER,
    eu INTEGER,
    fa INTEGER,
    ff INTEGER,
    fi INTEGER,
    fj INTEGER,
    fo INTEGER,
    fr INTEGER,
    fy INTEGER,
    ga INTEGER,
    gd INTEGER,
    gl INTEGER,
    gn INTEGER,
    gu INTEGER,
    gv INTEGER,
    ha INTEGER,
    he INTEGER,
    hi INTEGER,
    hr INTEGER,
    ht INTEGER,
    hu INTEGER,
    hy INTEGER,
    hz INTEGER,
    ia INTEGER,
    id INTEGER,
    ie INTEGER,
    ig INTEGER,
    ii INTEGER,
    is INTEGER,
    it INTEGER,
    iu INTEGER,
    ja INTEGER,
    jv INTEGER,
    ka INTEGER,
    kg INTEGER,
    ki INTEGER,
    kj INTEGER,
    kk INTEGER,
    kl INTEGER,
    km INTEGER,
    kn INTEGER,
    ko INTEGER,
    ks INTEGER,
    ku INTEGER,
    kv INTEGER,
    kw INTEGER,
    ky INTEGER,
    la INTEGER,
    lb INTEGER,
    lg INTEGER,
    li INTEGER,
    ln INTEGER,
    lo INTEGER,
    lt INTEGER,
    lv INTEGER,
    mg INTEGER,
    mh INTEGER,
    mi INTEGER,
    mk INTEGER,
    ml INTEGER,
    mn INTEGER,
    mo INTEGER,
    mr INTEGER,
    ms INTEGER,
    mt INTEGER,
    my INTEGER,
    nb INTEGER,
    nd INTEGER,
    ne INTEGER,
    nl INTEGER,
    nn INTEGER,
    no INTEGER,
    nv INTEGER,
    ny INTEGER,
    oc INTEGER,
    om INTEGER,
    or INTEGER,
    os INTEGER,
    pa INTEGER,
    pl INTEGER,
    ps INTEGER,
    pt INTEGER,
    qu INTEGER,
    rm INTEGER,
    rn INTEGER,
    ro INTEGER,
    ru INTEGER,
    rw INTEGER,
    sa INTEGER,
    sc INTEGER,
    sd INTEGER,
    se INTEGER,
    sg INTEGER,
    sh INTEGER,
    si INTEGER,
    sk INTEGER,
    sl INTEGER,
    sm INTEGER,
    sn INTEGER,
    so INTEGER,
    sq INTEGER,
    sr INTEGER,
    ss INTEGER,
    st INTEGER,
    su INTEGER,
    sv INTEGER,
    sw INTEGER,
    ta INTEGER,
    te INTEGER,
    tg INTEGER,
    th INTEGER,
    ti INTEGER,
    tk INTEGER,
    tl INTEGER,
    tn INTEGER,
    to INTEGER,
    tr INTEGER,
    ts INTEGER,
    tt INTEGER,
    tw INTEGER,
    ty INTEGER,
    ug INTEGER,
    uk INTEGER,
    ur INTEGER,
    uz INTEGER,
    vi INTEGER,
    wo INTEGER,
    xh INTEGER,
    xx INTEGER,
    yi INTEGER,
    yo INTEGER,
    za INTEGER,
    zh INTEGER,
    zu INTEGER,
    Abkhazian INTEGER,
    Afar INTEGER,
    Afrikaans INTEGER,
    Akan INTEGER,
    Albanian INTEGER,
    Amharic INTEGER,
    Arabic INTEGER,
    Aragonese INTEGER,
    Armenian INTEGER,
    Assamese INTEGER,
    Avaric INTEGER,
    Avestan INTEGER,
    Aymara INTEGER,
    Azerbaijani INTEGER,
    Bambara INTEGER,
    Bashkir INTEGER,
    Basque INTEGER,
    Belarusian INTEGER,
    Bengali INTEGER,
    Bislama INTEGER,
    Bosnian INTEGER,
    Breton INTEGER,
    Bulgarian INTEGER,
    Burmese INTEGER,
    Cantonese INTEGER,
    Catalan INTEGER,
    Chamorro INTEGER,
    Chechen INTEGER,
    Chichewa INTEGER,
    Chuvash INTEGER,
    Cornish INTEGER,
    Corsican INTEGER,
    Cree INTEGER,
    Croatian INTEGER,
    Czech INTEGER,
    Danish INTEGER,
    Divehi INTEGER,
    Dutch INTEGER,
    Dzongkha INTEGER,
    English INTEGER,
    Esperanto INTEGER,
    Estonian INTEGER,
    Ewe INTEGER,
    Faroese INTEGER,
    Fijian INTEGER,
    Finnish INTEGER,
    French INTEGER,
    Frisian INTEGER,
    Fulah INTEGER,
    Gaelic INTEGER,
    Galician INTEGER,
    Ganda INTEGER,
    Georgian INTEGER,
    German INTEGER,
    Greek INTEGER,
    Guarani INTEGER,
    Gujarati INTEGER,
    Haitian INTEGER,
    Hausa INTEGER,
    Hebrew INTEGER,
    Herero INTEGER,
    Hindi INTEGER,
    Hiri_Motu INTEGER,
    Hungarian INTEGER,
    Icelandic INTEGER,
    Ido INTEGER,
    Igbo INTEGER,
    Indonesian INTEGER,
    Interlingua INTEGER,
    Interlingue INTEGER,
    Inuktitut INTEGER,
    Inupiaq INTEGER,
    Irish INTEGER,
    Italian INTEGER,
    Japanese INTEGER,
    Javanese INTEGER,
    Kalaallisut INTEGER,
    Kannada INTEGER,
    Kanuri INTEGER,
    Kashmiri INTEGER,
    Kazakh INTEGER,
    Khmer INTEGER,
    Kikuyu INTEGER,
    Kinyarwanda INTEGER,
    Kirghiz INTEGER,
    Komi INTEGER,
    Kongo INTEGER,
    Korean INTEGER,
    Kuanyama INTEGER,
    Kurdish INTEGER,
    Lao INTEGER,
    Latin INTEGER,
    Latvian INTEGER,
    Letzeburgesch INTEGER,
    Limburgish INTEGER,
    Lingala INTEGER,
    Lithuanian INTEGER,
    Luba_Katanga INTEGER,
    Macedonian INTEGER,
    Malagasy INTEGER,
    Malay INTEGER,
    Malayalam INTEGER,
    Maltese INTEGER,
    Mandarin INTEGER,
    Maori INTEGER,
    Marathi INTEGER,
    Marshall INTEGER,
    Moldavian INTEGER,
    Mongolian INTEGER,
    Nauru INTEGER,
    Navajo INTEGER,
    Ndebele INTEGER,
    Ndonga INTEGER,
    Nepali INTEGER,
    No_Language INTEGER,
    Northern_Sami INTEGER,
    Norwegian INTEGER,
    Norwegian_Bokmal INTEGER,
    Norwegian_Nynorsk INTEGER,
    Occitan INTEGER,
    Ojibwa INTEGER,
    Oriya INTEGER,
    Oromo INTEGER,
    Ossetian INTEGER,
    Pali INTEGER,
    Persian INTEGER,
    Polish INTEGER,
    Portuguese INTEGER,
    Punjabi INTEGER,
    Pushto INTEGER,
    Quechua INTEGER,
    Raeto_Romance INTEGER,
    Romanian INTEGER,
    Rundi INTEGER,
    Russian INTEGER,
    Samoan INTEGER,
    Sango INTEGER,
    Sanskrit INTEGER,
    Sardinian INTEGER,
    Serbian INTEGER,
    Serbo_Croatian INTEGER,
    Shona INTEGER,
    Sindhi INTEGER,
    Sinhalese INTEGER,
    Slavic INTEGER,
    Slovak INTEGER,
    Slovenian INTEGER,
    Somali INTEGER,
    Sotho INTEGER,
    Spanish INTEGER,
    Sundanese INTEGER,
    Swahili INTEGER,
    Swati INTEGER,
    Swedish INTEGER,
    Tagalog INTEGER,
    Tahitian INTEGER,
    Tajik INTEGER,
    Tamil INTEGER,
    Tatar INTEGER,
    Telugu INTEGER,
    Thai INTEGER,
    Tibetan INTEGER,
    Tigrinya INTEGER,
    Tonga INTEGER,
    Tsonga INTEGER,
    Tswana INTEGER,
    Turkish INTEGER,
    Turkmen INTEGER,
    Twi INTEGER,
    Uighur INTEGER,
    Ukrainian INTEGER,
    Urdu INTEGER,
    Uzbek INTEGER,
    Venda INTEGER,
    Vietnamese INTEGER,
    Volapuk INTEGER,
    Walloon INTEGER,
    Welsh INTEGER,
    Wolof INTEGER,
    Xhosa INTEGER,
    Yi INTEGER,
    Yiddish INTEGER,
    Yoruba INTEGER,
    Zulu INTEGER,
    Afghanistan INTEGER,
    Albania INTEGER,
    Algeria INTEGER,
    American_Samoa INTEGER,
    Andorra INTEGER,
    Angola INTEGER,
    Anguilla INTEGER,
    Antarctica INTEGER,
    Antigua_and_Barbuda INTEGER,
    Argentina INTEGER,
    Armenia INTEGER,
    Aruba INTEGER,
    Australia INTEGER,
    Austria INTEGER,
    Azerbaijan INTEGER,
    Bahamas INTEGER,
    Bahrain INTEGER,
    Bangladesh INTEGER,
    Barbados INTEGER,
    Belarus INTEGER,
    Belgium INTEGER,
    Belize INTEGER,
    Benin INTEGER,
    Bermuda INTEGER,
    Bhutan INTEGER,
    Bolivia INTEGER,
    Bosnia_and_Herzegovina INTEGER,
    Botswana INTEGER,
    Brazil INTEGER,
    British_Indian_Ocean_Territory INTEGER,
    British_Virgin_Islands INTEGER,
    Brunei_Darussalam INTEGER,
    Bulgaria INTEGER,
    Burkina_Faso INTEGER,
    Burundi INTEGER,
    Cambodia INTEGER,
    Cameroon INTEGER,
    Canada INTEGER,
    Cape_Verde INTEGER,
    Cayman_Islands INTEGER,
    Central_African_Republic INTEGER,
    Chad INTEGER,
    Chile INTEGER,
    China INTEGER,
    Christmas_Island INTEGER,
    Cocos_Islands INTEGER,
    Colombia INTEGER,
    Comoros INTEGER,
    Congo INTEGER,
    Cook_Islands INTEGER,
    Costa_Rica INTEGER,
    Cote_D_Ivoire INTEGER,
    Croatia INTEGER,
    Cuba INTEGER,
    Cyprus INTEGER,
    Czech_Republic INTEGER,
    Czechoslovakia INTEGER,
    Denmark INTEGER,
    Djibouti INTEGER,
    Dominica INTEGER,
    Dominican_Republic INTEGER,
    Ecuador INTEGER,
    Egypt INTEGER,
    El_Salvador INTEGER,
    Equatorial_Guinea INTEGER,
    Eritrea INTEGER,
    Estonia INTEGER,
    Eswatini INTEGER,
    Ethiopia INTEGER,
    Fiji INTEGER,
    Finland INTEGER,
    France INTEGER,
    Gabon INTEGER,
    Gambia INTEGER,
    Georgia INTEGER,
    Germany INTEGER,
    Ghana INTEGER,
    Gibraltar INTEGER,
    Greece INTEGER,
    Greenland INTEGER,
    Grenada INTEGER,
    Guadeloupe INTEGER,
    Guam INTEGER,
    Guatemala INTEGER,
    Guinea INTEGER,
    Guinea_Bissau INTEGER,
    Guyana INTEGER,
    Haiti INTEGER,
    Honduras INTEGER,
    Hong_Kong INTEGER,
    Hungary INTEGER,
    Iceland INTEGER,
    India INTEGER,
    Indonesia INTEGER,
    Iran INTEGER,
    Iraq INTEGER,
    Ireland INTEGER,
    Israel INTEGER,
    Italy INTEGER,
    Jamaica INTEGER,
    Japan INTEGER,
    Jordan INTEGER,
    Kazakhstan INTEGER,
    Kenya INTEGER,
    Kiribati INTEGER,
    Korea_North INTEGER,
    Korea_South INTEGER,
    Kuwait INTEGER,
    Kyrgyzstan INTEGER,
    Laos INTEGER,
    Latvia INTEGER,
    Lebanon INTEGER,
    Lesotho INTEGER,
    Liberia INTEGER,
    Libya INTEGER,
    Liechtenstein INTEGER,
    Lithuania INTEGER,
    Luxembourg INTEGER,
    Macau INTEGER,
    Madagascar INTEGER,
    Malawi INTEGER,
    Malaysia INTEGER,
    Maldives INTEGER,
    Mali INTEGER,
    Malta INTEGER,
    Marshall_Islands INTEGER,
    Martinique INTEGER,
    Mauritania INTEGER,
    Mauritius INTEGER,
    Mexico INTEGER,
    Micronesia INTEGER,
    Moldova INTEGER,
    Monaco INTEGER,
    Mongolia INTEGER,
    Montenegro INTEGER,
    Montserrat INTEGER,
    Morocco INTEGER,
    Mozambique INTEGER,
    Namibia INTEGER,
    Nauru INTEGER,
    Nepal INTEGER,
    Netherlands INTEGER,
    New_Caledonia INTEGER,
    New_Zealand INTEGER,
    Nicaragua INTEGER,
    Niger INTEGER,
    Nigeria INTEGER,
    Niue INTEGER,
    Norfolk_Island INTEGER,
    North_Macedonia INTEGER,
    Northern_Mariana_Islands INTEGER,
    Norway INTEGER,
    Oman INTEGER,
    Pakistan INTEGER,
    Palau INTEGER,
    Panama INTEGER,
    Papua_New_Guinea INTEGER,
    Paraguay INTEGER,
    Peru INTEGER,
    Philippines INTEGER,
    Pitcairn_Islands INTEGER,
    Poland INTEGER,
    Portugal INTEGER,
    Puerto_Rico INTEGER,
    Qatar INTEGER,
    Romania INTEGER,
    Russia INTEGER,
    Rwanda INTEGER,
    Saint_Barthelemy INTEGER,
    Saint_Helena INTEGER,
    Saint_Kitts_and_Nevis INTEGER,
    Saint_Lucia INTEGER,
    Saint_Martin INTEGER,
    Saint_Pierre_and_Miquelon INTEGER,
    Saint_Vincent_and_Grenadines INTEGER,
    Samoa INTEGER,
    San_Marino INTEGER,
    Sao_Tome_and_Principe INTEGER,
    Saudi_Arabia INTEGER,
    Senegal INTEGER,
    Serbia INTEGER,
    Seychelles INTEGER,
    Sierra_Leone INTEGER,
    Singapore INTEGER,
    Sint_Maarten INTEGER,
    Slovakia INTEGER,
    Slovenia INTEGER,
    Solomon_Islands INTEGER,
    Somalia INTEGER,
    South_Africa INTEGER,
    South_Georgia_and_the_South_Sandwich_Islands INTEGER,
    South_Sudan INTEGER,
    Spain INTEGER,
    Sri_Lanka INTEGER,
    Sudan INTEGER,
    Suriname INTEGER,
    Svalbard_and_Jan_Mayen INTEGER,
    Swaziland INTEGER,
    Sweden INTEGER,
    Switzerland INTEGER,
    Syria INTEGER,
    Taiwan INTEGER,
    Tajikistan INTEGER,
    Tanzania INTEGER,
    Thailand INTEGER,
    Timor_Leste INTEGER,
    Togo INTEGER,
    Tokelau INTEGER,
    Tonga INTEGER,
    Trinidad_and_Tobago INTEGER,
    Tunisia INTEGER,
    Turkey INTEGER,
    Turkmenistan INTEGER,
    Tuvalu INTEGER,
    Uganda INTEGER,
    Ukraine INTEGER,
    United_Arab_Emirates INTEGER,
    United_Kingdom INTEGER,
    United_States INTEGER,
    Uruguay INTEGER,
    Uzbekistan INTEGER,
    Vanuatu INTEGER,
    Vatican_City INTEGER,
    Venezuela INTEGER,
    Vietnam INTEGER,
    Wallis_and_Futuna INTEGER,
    Western_Sahara INTEGER,
    Yemen INTEGER,
    Zambia INTEGER,
    Zimbabwe INTEGER,
    release_day INTEGER,
    release_month INTEGER,
    release_year INTEGER,
    overview_w2v0 REAL,
    overview_w2v1 REAL,
    overview_w2v2 REAL,
    overview_w2v3 REAL,
    overview_w2v4 REAL,
overview_w2v5 REAL,
overview_w2v6 REAL,
overview_w2v7 REAL,
overview_w2v8 REAL,
overview_w2v9 REAL,
overview_w2v10 REAL,
overview_w2v11 REAL,
overview_w2v12 REAL,
overview_w2v13 REAL,
overview_w2v14 REAL,
overview_w2v15 REAL,
overview_w2v16 REAL,
overview_w2v17 REAL,
overview_w2v18 REAL,
overview_w2v19 REAL,
overview_w2v20 REAL,
overview_w2v21 REAL,
overview_w2v22 REAL,
overview_w2v23 REAL,
overview_w2v24 REAL,
overview_w2v25 REAL,
overview_w2v26 REAL,
overview_w2v27 REAL,
overview_w2v28 REAL,
overview_w2v29 REAL,
overview_w2v30 REAL,
overview_w2v31 REAL,
overview_w2v32 REAL,
overview_w2v33 REAL,
overview_w2v34 REAL,
overview_w2v35 REAL,
overview_w2v36 REAL,
overview_w2v37 REAL,
overview_w2v38 REAL,
overview_w2v39 REAL,
overview_w2v40 REAL,
overview_w2v41 REAL,
overview_w2v42 REAL,
overview_w2v43 REAL,
overview_w2v44 REAL,
overview_w2v45 REAL,
overview_w2v46 REAL,
overview_w2v47 REAL,
overview_w2v48 REAL,
overview_w2v49 REAL,
overview_w2v50 REAL,
overview_w2v51 REAL,
overview_w2v52 REAL,
overview_w2v53 REAL,
overview_w2v54 REAL,
overview_w2v55 REAL,
overview_w2v56 REAL,
overview_w2v57 REAL,
overview_w2v58 REAL,
overview_w2v59 REAL,
overview_w2v60 REAL,
overview_w2v61 REAL,
overview_w2v62 REAL,
overview_w2v63 REAL,
overview_w2v64 REAL,
overview_w2v65 REAL,
overview_w2v66 REAL,
overview_w2v67 REAL,
overview_w2v68 REAL,
overview_w2v69 REAL,
overview_w2v70 REAL,
overview_w2v71 REAL,
overview_w2v72 REAL,
overview_w2v73 REAL,
overview_w2v74 REAL,
overview_w2v75 REAL,
overview_w2v76 REAL,
overview_w2v77 REAL,
overview_w2v78 REAL,
overview_w2v79 REAL,
overview_w2v80 REAL,
overview_w2v81 REAL,
overview_w2v82 REAL,
overview_w2v83 REAL,
overview_w2v84 REAL,
overview_w2v85 REAL,
overview_w2v86 REAL,
overview_w2v87 REAL,
overview_w2v88 REAL,
overview_w2v89 REAL,
overview_w2v90 REAL,
overview_w2v91 REAL,
overview_w2v92 REAL,
overview_w2v93 REAL,
overview_w2v94 REAL,
overview_w2v95 REAL,
overview_w2v96 REAL,
overview_w2v97 REAL,
overview_w2v98 REAL,
overview_w2v99 REAL,
overview_w2v100 REAL,
overview_w2v101 REAL,
overview_w2v102 REAL,
overview_w2v103 REAL,
overview_w2v104 REAL,
overview_w2v105 REAL,
overview_w2v106 REAL,
overview_w2v107 REAL,
overview_w2v108 REAL,
overview_w2v109 REAL,
overview_w2v110 REAL,
overview_w2v111 REAL,
overview_w2v112 REAL,
overview_w2v113 REAL,
overview_w2v114 REAL,
overview_w2v115 REAL,
overview_w2v116 REAL,
overview_w2v117 REAL,
overview_w2v118 REAL,
overview_w2v119 REAL,
overview_w2v120 REAL,
overview_w2v121 REAL,
overview_w2v122 REAL,
overview_w2v123 REAL,
overview_w2v124 REAL,
overview_w2v125 REAL,
overview_w2v126 REAL,
overview_w2v127 REAL,
overview_w2v128 REAL,
overview_w2v129 REAL,
overview_w2v130 REAL,
overview_w2v131 REAL,
overview_w2v132 REAL,
overview_w2v133 REAL,
overview_w2v134 REAL,
overview_w2v135 REAL,
overview_w2v136 REAL,
overview_w2v137 REAL,
overview_w2v138 REAL,
overview_w2v139 REAL,
overview_w2v140 REAL,
overview_w2v141 REAL,
overview_w2v142 REAL,
overview_w2v143 REAL,
overview_w2v144 REAL,
overview_w2v145 REAL,
overview_w2v146 REAL,
overview_w2v147 REAL,
overview_w2v148 REAL,
overview_w2v149 REAL,
overview_w2v150 REAL,
overview_w2v151 REAL,
overview_w2v152 REAL,
overview_w2v153 REAL,
overview_w2v154 REAL,
overview_w2v155 REAL,
overview_w2v156 REAL,
overview_w2v157 REAL,
overview_w2v158 REAL,
overview_w2v159 REAL,
overview_w2v160 REAL,
overview_w2v161 REAL,
overview_w2v162 REAL,
overview_w2v163 REAL,
overview_w2v164 REAL,
overview_w2v165 REAL,
overview_w2v166 REAL,
overview_w2v167 REAL,
overview_w2v168 REAL,
overview_w2v169 REAL,
overview_w2v170 REAL,
overview_w2v171 REAL,
overview_w2v172 REAL,
overview_w2v173 REAL,
overview_w2v174 REAL,
overview_w2v175 REAL,
overview_w2v176 REAL,
overview_w2v177 REAL,
overview_w2v178 REAL,
overview_w2v179 REAL,
overview_w2v180 REAL,
overview_w2v181 REAL,
overview_w2v182 REAL,
overview_w2v183 REAL,
overview_w2v184 REAL,
overview_w2v185 REAL,
overview_w2v186 REAL,
overview_w2v187 REAL,
overview_w2v188 REAL,
overview_w2v189 REAL,
overview_w2v190 REAL,
overview_w2v191 REAL,
overview_w2v192 REAL,
overview_w2v193 REAL,
overview_w2v194 REAL,
overview_w2v195 REAL,
overview_w2v196 REAL,
overview_w2v197 REAL,
overview_w2v198 REAL,
overview_w2v199 REAL,
overview_w2v200 REAL,
overview_w2v201 REAL,
overview_w2v202 REAL,
overview_w2v203 REAL,
overview_w2v204 REAL,
overview_w2v205 REAL,
overview_w2v206 REAL,
overview_w2v207 REAL,
overview_w2v208 REAL,
overview_w2v209 REAL,
overview_w2v210 REAL,
overview_w2v211 REAL,
overview_w2v212 REAL,
overview_w2v213 REAL,
overview_w2v214 REAL,
overview_w2v215 REAL,
overview_w2v216 REAL,
overview_w2v217 REAL,
overview_w2v218 REAL,
overview_w2v219 REAL,
overview_w2v220 REAL,
overview_w2v221 REAL,
overview_w2v222 REAL,
overview_w2v223 REAL,
overview_w2v224 REAL,
overview_w2v225 REAL,
overview_w2v226 REAL,
overview_w2v227 REAL,
overview_w2v228 REAL,
overview_w2v229 REAL,
overview_w2v230 REAL,
overview_w2v231 REAL,
overview_w2v232 REAL,
overview_w2v233 REAL,
overview_w2v234 REAL,
overview_w2v235 REAL,
overview_w2v236 REAL,
overview_w2v237 REAL,
overview_w2v238 REAL,
overview_w2v239 REAL,
overview_w2v240 REAL,
overview_w2v241 REAL,
overview_w2v242 REAL,
overview_w2v243 REAL,
overview_w2v244 REAL,
overview_w2v245 REAL,
overview_w2v246 REAL,
overview_w2v247 REAL,
overview_w2v248 REAL,
overview_w2v249 REAL,
overview_w2v250 REAL,
overview_w2v251 REAL,
overview_w2v252 REAL,
overview_w2v253 REAL,
overview_w2v254 REAL,
overview_w2v255 REAL,
overview_w2v256 REAL,
overview_w2v257 REAL,
overview_w2v258 REAL,
overview_w2v259 REAL,
overview_w2v260 REAL,
overview_w2v261 REAL,
overview_w2v262 REAL,
overview_w2v263 REAL,
overview_w2v264 REAL,
overview_w2v265 REAL,
overview_w2v266 REAL,
overview_w2v267 REAL,
overview_w2v268 REAL,
overview_w2v269 REAL,
overview_w2v270 REAL,
overview_w2v271 REAL,
overview_w2v272 REAL,
overview_w2v273 REAL,
overview_w2v274 REAL,
overview_w2v275 REAL,
overview_w2v276 REAL,
overview_w2v277 REAL,
overview_w2v278 REAL,
overview_w2v279 REAL,
overview_w2v280 REAL,
overview_w2v281 REAL,
overview_w2v282 REAL,
overview_w2v283 REAL,
overview_w2v284 REAL,
overview_w2v285 REAL,
overview_w2v286 REAL,
overview_w2v287 REAL,
overview_w2v288 REAL,
overview_w2v289 REAL,
overview_w2v290 REAL,
overview_w2v291 REAL,
overview_w2v292 REAL,
overview_w2v293 REAL,
overview_w2v294 REAL,
overview_w2v295 REAL,
overview_w2v296 REAL,
overview_w2v297 REAL,
overview_w2v298 REAL,
overview_w2v299 REAL,
keywords_w2v0 REAL,
keywords_w2v1 REAL,
keywords_w2v2 REAL,
keywords_w2v3 REAL,
keywords_w2v4 REAL,
keywords_w2v5 REAL,
keywords_w2v6 REAL,
keywords_w2v7 REAL,
keywords_w2v8 REAL,
keywords_w2v9 REAL,
keywords_w2v10 REAL,
keywords_w2v11 REAL,
keywords_w2v12 REAL,
keywords_w2v13 REAL,
keywords_w2v14 REAL,
keywords_w2v15 REAL,
keywords_w2v16 REAL,
keywords_w2v17 REAL,
keywords_w2v18 REAL,
keywords_w2v19 REAL,
keywords_w2v20 REAL,
keywords_w2v21 REAL,
keywords_w2v22 REAL,
keywords_w2v23 REAL,
keywords_w2v24 REAL,
keywords_w2v25 REAL,
keywords_w2v26 REAL,
keywords_w2v27 REAL,
keywords_w2v28 REAL,
keywords_w2v29 REAL,
keywords_w2v30 REAL,
keywords_w2v31 REAL,
keywords_w2v32 REAL,
keywords_w2v33 REAL,
keywords_w2v34 REAL,
keywords_w2v35 REAL,
keywords_w2v36 REAL,
keywords_w2v37 REAL,
keywords_w2v38 REAL,
keywords_w2v39 REAL,
keywords_w2v40 REAL,
keywords_w2v41 REAL,
keywords_w2v42 REAL,
keywords_w2v43 REAL,
keywords_w2v44 REAL,
keywords_w2v45 REAL,
keywords_w2v46 REAL,
keywords_w2v47 REAL,
keywords_w2v48 REAL,
keywords_w2v49 REAL,
keywords_w2v50 REAL,
keywords_w2v51 REAL,
keywords_w2v52 REAL,
keywords_w2v53 REAL,
keywords_w2v54 REAL,
keywords_w2v55 REAL,
keywords_w2v56 REAL,
keywords_w2v57 REAL,
keywords_w2v58 REAL,
keywords_w2v59 REAL,
keywords_w2v60 REAL,
keywords_w2v61 REAL,
keywords_w2v62 REAL,
keywords_w2v63 REAL,
keywords_w2v64 REAL,
keywords_w2v65 REAL,
keywords_w2v66 REAL,
keywords_w2v67 REAL,
keywords_w2v68 REAL,
keywords_w2v69 REAL,
keywords_w2v70 REAL,
keywords_w2v71 REAL,
keywords_w2v72 REAL,
keywords_w2v73 REAL,
keywords_w2v74 REAL,
keywords_w2v75 REAL,
keywords_w2v76 REAL,
keywords_w2v77 REAL,
keywords_w2v78 REAL,
keywords_w2v79 REAL,
keywords_w2v80 REAL,
keywords_w2v81 REAL,
keywords_w2v82 REAL,
keywords_w2v83 REAL,
keywords_w2v84 REAL,
keywords_w2v85 REAL,
keywords_w2v86 REAL,
keywords_w2v87 REAL,
keywords_w2v88 REAL,
keywords_w2v89 REAL,
keywords_w2v90 REAL,
keywords_w2v91 REAL,
keywords_w2v92 REAL,
keywords_w2v93 REAL,
keywords_w2v94 REAL,
keywords_w2v95 REAL,
keywords_w2v96 REAL,
keywords_w2v97 REAL,
keywords_w2v98 REAL,
keywords_w2v99 REAL,
keywords_w2v100 REAL,
keywords_w2v101 REAL,
keywords_w2v102 REAL,
keywords_w2v103 REAL,
keywords_w2v104 REAL,
keywords_w2v105 REAL,
keywords_w2v106 REAL,
keywords_w2v107 REAL,
keywords_w2v108 REAL,
keywords_w2v109 REAL,
keywords_w2v110 REAL,
keywords_w2v111 REAL,
keywords_w2v112 REAL,
keywords_w2v113 REAL,
keywords_w2v114 REAL,
keywords_w2v115 REAL,
keywords_w2v116 REAL,
keywords_w2v117 REAL,
keywords_w2v118 REAL,
keywords_w2v119 REAL,
keywords_w2v120 REAL,
keywords_w2v121 REAL,
keywords_w2v122 REAL,
keywords_w2v123 REAL,
keywords_w2v124 REAL,
keywords_w2v125 REAL,
keywords_w2v126 REAL,
keywords_w2v127 REAL,
keywords_w2v128 REAL,
keywords_w2v129 REAL,
keywords_w2v130 REAL,
keywords_w2v131 REAL,
keywords_w2v132 REAL,
keywords_w2v133 REAL,
keywords_w2v134 REAL,
keywords_w2v135 REAL,
keywords_w2v136 REAL,
keywords_w2v137 REAL,
keywords_w2v138 REAL,
keywords_w2v139 REAL,
keywords_w2v140 REAL,
keywords_w2v141 REAL,
keywords_w2v142 REAL,
keywords_w2v143 REAL,
keywords_w2v144 REAL,
keywords_w2v145 REAL,
keywords_w2v146 REAL,
keywords_w2v147 REAL,
keywords_w2v148 REAL,
keywords_w2v149 REAL,
keywords_w2v150 REAL,
keywords_w2v151 REAL,
keywords_w2v152 REAL,
keywords_w2v153 REAL,
keywords_w2v154 REAL,
keywords_w2v155 REAL,
keywords_w2v156 REAL,
keywords_w2v157 REAL,
keywords_w2v158 REAL,
keywords_w2v159 REAL,
keywords_w2v160 REAL,
keywords_w2v161 REAL,
keywords_w2v162 REAL,
keywords_w2v163 REAL,
keywords_w2v164 REAL,
keywords_w2v165 REAL,
keywords_w2v166 REAL,
keywords_w2v167 REAL,
keywords_w2v168 REAL,
keywords_w2v169 REAL,
keywords_w2v170 REAL,
keywords_w2v171 REAL,
keywords_w2v172 REAL,
keywords_w2v173 REAL,
keywords_w2v174 REAL,
keywords_w2v175 REAL,
keywords_w2v176 REAL,
keywords_w2v177 REAL,
keywords_w2v178 REAL,
keywords_w2v179 REAL,
keywords_w2v180 REAL,
keywords_w2v181 REAL,
keywords_w2v182 REAL,
keywords_w2v183 REAL,
keywords_w2v184 REAL,
keywords_w2v185 REAL,
keywords_w2v186 REAL,
keywords_w2v187 REAL,
keywords_w2v188 REAL,
keywords_w2v189 REAL,
keywords_w2v190 REAL,
keywords_w2v191 REAL,
keywords_w2v192 REAL,
keywords_w2v193 REAL,
keywords_w2v194 REAL,
keywords_w2v195 REAL,
keywords_w2v196 REAL,
keywords_w2v197 REAL,
keywords_w2v198 REAL,
keywords_w2v199 REAL,
keywords_w2v200 REAL,
keywords_w2v201 REAL,
keywords_w2v202 REAL,
keywords_w2v203 REAL,
keywords_w2v204 REAL,
keywords_w2v205 REAL,
keywords_w2v206 REAL,
keywords_w2v207 REAL,
keywords_w2v208 REAL,
keywords_w2v209 REAL,
keywords_w2v210 REAL,
keywords_w2v211 REAL,
keywords_w2v212 REAL,
keywords_w2v213 REAL,
keywords_w2v214 REAL,
keywords_w2v215 REAL,
keywords_w2v216 REAL,
keywords_w2v217 REAL,
keywords_w2v218 REAL,
keywords_w2v219 REAL,
keywords_w2v220 REAL,
keywords_w2v221 REAL,
keywords_w2v222 REAL,
keywords_w2v223 REAL,
keywords_w2v224 REAL,
keywords_w2v225 REAL,
keywords_w2v226 REAL,
keywords_w2v227 REAL,
keywords_w2v228 REAL,
keywords_w2v229 REAL,
keywords_w2v230 REAL,
keywords_w2v231 REAL,
keywords_w2v232 REAL,
keywords_w2v233 REAL,
keywords_w2v234 REAL,
keywords_w2v235 REAL,
keywords_w2v236 REAL,
keywords_w2v237 REAL,
keywords_w2v238 REAL,
keywords_w2v239 REAL,
keywords_w2v240 REAL,
keywords_w2v241 REAL,
keywords_w2v242 REAL,
keywords_w2v243 REAL,
keywords_w2v244 REAL,
keywords_w2v245 REAL,
keywords_w2v246 REAL,
keywords_w2v247 REAL,
keywords_w2v248 REAL,
keywords_w2v249 REAL,
keywords_w2v250 REAL,
keywords_w2v251 REAL,
keywords_w2v252 REAL,
keywords_w2v253 REAL,
keywords_w2v254 REAL,
keywords_w2v255 REAL,
keywords_w2v256 REAL,
keywords_w2v257 REAL,
keywords_w2v258 REAL,
keywords_w2v259 REAL,
keywords_w2v260 REAL,
keywords_w2v261 REAL,
keywords_w2v262 REAL,
keywords_w2v263 REAL,
keywords_w2v264 REAL,
keywords_w2v265 REAL,
keywords_w2v266 REAL,
keywords_w2v267 REAL,
keywords_w2v268 REAL,
keywords_w2v269 REAL,
keywords_w2v270 REAL,
keywords_w2v271 REAL,
keywords_w2v272 REAL,
keywords_w2v273 REAL,
keywords_w2v274 REAL,
keywords_w2v275 REAL,
keywords_w2v276 REAL,
keywords_w2v277 REAL,
keywords_w2v278 REAL,
keywords_w2v279 REAL,
keywords_w2v280 REAL,
keywords_w2v281 REAL,
keywords_w2v282 REAL,
keywords_w2v283 REAL,
keywords_w2v284 REAL,
keywords_w2v285 REAL,
keywords_w2v286 REAL,
keywords_w2v287 REAL,
keywords_w2v288 REAL,
keywords_w2v289 REAL,
keywords_w2v290 REAL,
keywords_w2v291 REAL,
keywords_w2v292 REAL,
keywords_w2v293 REAL,
keywords_w2v294 REAL,
keywords_w2v295 REAL,
keywords_w2v296 REAL,
keywords_w2v297 REAL,
keywords_w2v298 REAL,
keywords_w2v299 REAL,
title_w2v0 REAL,
title_w2v1 REAL,
title_w2v2 REAL,
title_w2v3 REAL,
title_w2v4 REAL,
title_w2v5 REAL,
title_w2v6 REAL,
title_w2v7 REAL,
title_w2v8 REAL,
title_w2v9 REAL,
title_w2v10 REAL,
title_w2v11 REAL,
title_w2v12 REAL,
title_w2v13 REAL,
title_w2v14 REAL,
title_w2v15 REAL,
title_w2v16 REAL,
title_w2v17 REAL,
title_w2v18 REAL,
title_w2v19 REAL,
title_w2v20 REAL,
title_w2v21 REAL,
title_w2v22 REAL,
title_w2v23 REAL,
title_w2v24 REAL,
title_w2v25 REAL,
title_w2v26 REAL,
title_w2v27 REAL,
title_w2v28 REAL,
title_w2v29 REAL,
title_w2v30 REAL,
title_w2v31 REAL,
title_w2v32 REAL,
title_w2v33 REAL,
title_w2v34 REAL,
title_w2v35 REAL,
title_w2v36 REAL,
title_w2v37 REAL,
title_w2v38 REAL,
title_w2v39 REAL,
title_w2v40 REAL,
title_w2v41 REAL,
title_w2v42 REAL,
title_w2v43 REAL,
title_w2v44 REAL,
title_w2v45 REAL,
title_w2v46 REAL,
title_w2v47 REAL,
title_w2v48 REAL,
title_w2v49 REAL,
title_w2v50 REAL,
title_w2v51 REAL,
title_w2v52 REAL,
title_w2v53 REAL,
title_w2v54 REAL,
title_w2v55 REAL,
title_w2v56 REAL,
title_w2v57 REAL,
title_w2v58 REAL,
title_w2v59 REAL,
title_w2v60 REAL,
title_w2v61 REAL,
title_w2v62 REAL,
title_w2v63 REAL,
title_w2v64 REAL,
title_w2v65 REAL,
title_w2v66 REAL,
title_w2v67 REAL,
title_w2v68 REAL,
title_w2v69 REAL,
title_w2v70 REAL,
title_w2v71 REAL,
title_w2v72 REAL,
title_w2v73 REAL,
title_w2v74 REAL,
title_w2v75 REAL,
title_w2v76 REAL,
title_w2v77 REAL,
title_w2v78 REAL,
title_w2v79 REAL,
title_w2v80 REAL,
title_w2v81 REAL,
title_w2v82 REAL,
title_w2v83 REAL,
title_w2v84 REAL,
title_w2v85 REAL,
title_w2v86 REAL,
title_w2v87 REAL,
title_w2v88 REAL,
title_w2v89 REAL,
title_w2v90 REAL,
title_w2v91 REAL,
title_w2v92 REAL,
title_w2v93 REAL,
title_w2v94 REAL,
title_w2v95 REAL,
title_w2v96 REAL,
title_w2v97 REAL,
title_w2v98 REAL,
title_w2v99 REAL,
title_w2v100 REAL,
title_w2v101 REAL,
title_w2v102 REAL,
title_w2v103 REAL,
title_w2v104 REAL,
title_w2v105 REAL,
title_w2v106 REAL,
title_w2v107 REAL,
title_w2v108 REAL,
title_w2v109 REAL,
title_w2v110 REAL,
title_w2v111 REAL,
title_w2v112 REAL,
title_w2v113 REAL,
title_w2v114 REAL,
title_w2v115 REAL,
title_w2v116 REAL,
title_w2v117 REAL,
title_w2v118 REAL,
title_w2v119 REAL,
title_w2v120 REAL,
title_w2v121 REAL,
title_w2v122 REAL,
title_w2v123 REAL,
title_w2v124 REAL,
title_w2v125 REAL,
title_w2v126 REAL,
title_w2v127 REAL,
title_w2v128 REAL,
title_w2v129 REAL,
title_w2v130 REAL,
title_w2v131 REAL,
title_w2v132 REAL,
title_w2v133 REAL,
title_w2v134 REAL,
title_w2v135 REAL,
title_w2v136 REAL,
title_w2v137 REAL,
title_w2v138 REAL,
title_w2v139 REAL,
title_w2v140 REAL,
title_w2v141 REAL,
title_w2v142 REAL,
title_w2v143 REAL,
title_w2v144 REAL,
title_w2v145 REAL,
title_w2v146 REAL,
title_w2v147 REAL,
title_w2v148 REAL,
title_w2v149 REAL,
title_w2v150 REAL,
title_w2v151 REAL,
title_w2v152 REAL,
title_w2v153 REAL,
title_w2v154 REAL,
title_w2v155 REAL,
title_w2v156 REAL,
title_w2v157 REAL,
title_w2v158 REAL,
title_w2v159 REAL,
title_w2v160 REAL,
title_w2v161 REAL,
title_w2v162 REAL,
title_w2v163 REAL,
title_w2v164 REAL,
title_w2v165 REAL,
title_w2v166 REAL,
title_w2v167 REAL,
title_w2v168 REAL,
title_w2v169 REAL,
title_w2v170 REAL,
title_w2v171 REAL,
title_w2v172 REAL,
title_w2v173 REAL,
title_w2v174 REAL,
title_w2v175 REAL,
title_w2v176 REAL,
title_w2v177 REAL,
title_w2v178 REAL,
title_w2v179 REAL,
title_w2v180 REAL,
title_w2v181 REAL,
title_w2v182 REAL,
title_w2v183 REAL,
title_w2v184 REAL,
title_w2v185 REAL,
title_w2v186 REAL,
title_w2v187 REAL,
title_w2v188 REAL,
title_w2v189 REAL,
title_w2v190 REAL,
title_w2v191 REAL,
title_w2v192 REAL,
title_w2v193 REAL,
title_w2v194 REAL,
title_w2v195 REAL,
title_w2v196 REAL,
title_w2v197 REAL,
title_w2v198 REAL,
title_w2v199 REAL,
title_w2v200 REAL,
title_w2v201 REAL,
title_w2v202 REAL,
title_w2v203 REAL,
title_w2v204 REAL,
title_w2v205 REAL,
title_w2v206 REAL,
title_w2v207 REAL,
title_w2v208 REAL,
title_w2v209 REAL,
title_w2v210 REAL,
title_w2v211 REAL,
title_w2v212 REAL,
title_w2v213 REAL,
title_w2v214 REAL,
title_w2v215 REAL,
title_w2v216 REAL,
title_w2v217 REAL,
title_w2v218 REAL,
title_w2v219 REAL,
title_w2v220 REAL,
title_w2v221 REAL,
title_w2v222 REAL,
title_w2v223 REAL,
title_w2v224 REAL,
title_w2v225 REAL,
title_w2v226 REAL,
title_w2v227 REAL,
title_w2v228 REAL,
title_w2v229 REAL,
title_w2v230 REAL,
title_w2v231 REAL,
title_w2v232 REAL,
title_w2v233 REAL,
title_w2v234 REAL,
title_w2v235 REAL,
title_w2v236 REAL,
title_w2v237 REAL,
title_w2v238 REAL,
title_w2v239 REAL,
title_w2v240 REAL,
title_w2v241 REAL,
title_w2v242 REAL,
title_w2v243 REAL,
title_w2v244 REAL,
title_w2v245 REAL,
title_w2v246 REAL,
title_w2v247 REAL,
title_w2v248 REAL,
title_w2v249 REAL,
title_w2v250 REAL,
title_w2v251 REAL,
title_w2v252 REAL,
title_w2v253 REAL,
title_w2v254 REAL,
title_w2v255 REAL,
title_w2v256 REAL,
title_w2v257 REAL,
title_w2v258 REAL,
title_w2v259 REAL,
title_w2v260 REAL,
title_w2v261 REAL,
title_w2v262 REAL,
title_w2v263 REAL,
title_w2v264 REAL,
title_w2v265 REAL,
title_w2v266 REAL,
title_w2v267 REAL,
title_w2v268 REAL,
title_w2v269 REAL,
title_w2v270 REAL,
title_w2v271 REAL,
title_w2v272 REAL,
title_w2v273 REAL,
title_w2v274 REAL,
title_w2v275 REAL,
title_w2v276 REAL,
title_w2v277 REAL,
title_w2v278 REAL,
title_w2v279 REAL,
title_w2v280 REAL,
title_w2v281 REAL,
title_w2v282 REAL,
title_w2v283 REAL,
title_w2v284 REAL,
title_w2v285 REAL,
title_w2v286 REAL,
title_w2v287 REAL,
title_w2v288 REAL,
title_w2v289 REAL,
title_w2v290 REAL,
title_w2v291 REAL,
title_w2v292 REAL,
title_w2v293 REAL,
title_w2v294 REAL,
title_w2v295 REAL,
title_w2v296 REAL,
title_w2v297 REAL,
title_w2v298 REAL,
title_w2v299 REAL
  
)
''')
    connection.commit()
    connection.close()
    print("Database initialized and table created.")


# Initialize the database
initialize_database()

# Start monitoring the database
if __name__ == "__main__":
    print("Starting database monitoring...")
    monitor_database()
